<!DOCTYPE html>
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" type="text/css" href="./bootstrap/css/bootstrap.min.css">

    <link rel="stylesheet" type="text/css" href="./fontawesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="./bootstrap-icons/bootstrap-icons.css">

    <title>UPS Information</title>
    <style>
        :root {
            --header-strip-bg: #d3d3d3; 
            --header-strip-colour: black; 
            --header-strip-icon-colour: darkblue; 
            --header-strip-font-size: 20px; 
            --header-strip-pill-font-size: 11px; 
            --header-strip-icon-size: 19px; 
            --header-strip-font-weight: bold; 
        
            --body-font: 'Nunito', sans-serif;
            --body-font-size: 16px;
        }
        .header-strip {
            background-color: var(--header-strip-bg);
            font-size: var(--header-strip-font-size);
            color: var(--header-strip-colour);
        }
        .header-icons {
            color: var(--header-strip-icon-colour);
            font-size: var(--header-strip-icon-size);
            font-weight: var(--header-strip-font-weight);
            font-style: normal;
        }
        .header-icon-pill {
            font-size: var(--header-strip-pill-font-size);
            font-style: normal;
        }
        
        body {
            font-family: var(--body-font);
            font-size: var(--body-font-size); 
        } 
        </style>
        
  </head>
  <body>
<!-- Body content title bar  -->
<div class="container-fluid d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center px-2 pt-0 pb-1 header-strip"> 
    <!--=== Left ===-->
    <div>
      <span class="header-strip"><i class="fa-solid fa-power-off"></i> UPS Monitor</span>
    </div>
    <!--=== Centre ===-->
    <div>
        <span class="text-muted align-text-top header-strip">System Summary</span>
    </div>
    <!--=== Right ===-->
    <div class="d-inline pt-2">
      <span class="pe-1">
        <a href="#"><i class="bi-house px-0 header-icons"></i></a>
      </span>        
      <span class="">
        <a href="#"><i class="bi-sun pe-1 header-icons"></i></a>
      </span>        
      <span class="" id="dst-topbar-status">
        <!-- <i class="fa-solid fa-plug-circle-bolt"></i> -->
        <i class="bi bi-plugin"></i>
      </span>        
      <span class="ps-1 pe-1" id="dst-badge-info">
        <i class="bi-info-circle position-relative header-icons">
        <span class="d-none position-absolute top-0 start-100 translate-middle badge rounded-pill bg-success header-icon-pill">
         0
        </span>
        </i>
      </span>        
      <span class="ps-1 pe-1" id="dst-badge-warn">
        <i class="bi-exclamation-triangle position-relative header-icons">
        <span class="d-none position-absolute top-0 start-100 translate-middle badge rounded-pill bg-warning header-icon-pill" style="color: black;">
          0
        </span>
        </i>
      </span>        
      <span class="ps-1 pe-1" id="dst-badge-alert">
        <i class="bi-bell position-relative header-icons">
      <span class="d-none position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger header-icon-pill">
        0
    </span>
        </i>
      </span>        
  
      <i class="bi-question-circle ps-2 header-icons" data-bs-toggle="modal" data-bs-target="#helpModal"></i>
    </div>
  </div>

<div class="container bg-light">
<div class="row py-2 my-1">
    <!-- <div class="col-8 align-self-center d-flex d-inline"> -->
    <div class="col-8 justify-content-between d-flex d-inline">
            <h3>UPS Status </h3>&nbsp 
            <div id="db1"></div>&nbsp
            <div id="db2"></div>
            <div class="spinner-border" role="status" id="load-spin"> </div>            
            <!-- <span>Loading...</span> -->
        </div>
    <!-- align-self-center -->
    <div class="col-4 d-flex justify-content-end" id="dst-headline"> 
        <i class="fa-solid fa-plug-circle-exclamation h1 text-muted pe-1"></i> 
        <i class="fa-solid fa-battery-empty h1 text-muted pe-1"></i>
        <!-- <i class="fa-solid fa-bell h1 text-muted"></i> -->
        <i class="fa-solid fa-volume-off h1 text-muted pe-1"></i>
    </div>
</div>
</div>

<div class="container bg-light">
<div class="row">
    <div class="col my-2">
        <span class="h3">
        <i class="fa-solid fa-charging-station text-primary"></i>
        System Status
    </span>
    </div>
</div>
<div class="row d-flex justify-content-center text-center">
    <div class="col-md-4 col-sm-6 my-2">
        <div id="dst-vin">
            <img src="./graphics/0.png">
        </div>
    </div>
    <div class="col-md-4 col-sm-6 my-2">
        <div id="dst-vout">
            <img src="./graphics/1.png">
        </div>
    </div>
    <div class="col-md-4 col-sm-6 my-2">
        <div id="dst-outload">
            <img src="./graphics/2.png">
        </div>
    </div>
    <div class="col-md-4 col-sm-6">
    </div>
</div>

<div class="row">
    <div class="col my-2">
        <span class="h3">
            <i class="fa-solid fa-car-battery text-primary"></i>
        Battery Status
        </span>
    </div>
</div>
<div class="row d-flex justify-content-center text-center">
        <div class="col-md-4 col-sm-6 my-2">
            <div id="dst-bchar">
                <img src="./graphics/3.png">
            </div>
        </div>
    <div class="col-md-4 col-sm-6 my-2">
        <div id="dst-bvolt">
            <img src="./graphics/4.png">
        </div>
    </div>
    <div class="col-md-4 col-sm-6 my-2">
        <div id="dst-runtime">
            <img src="./graphics/5.png">
        </div>
    </div>
    <div class="col-md-4 col-sm-6">
    </div>
</div>
</div>

<div class="container bg-light">
    <div class="row py-2 my-1">
        <div class="col-4 my-2">
            <h2>Diagnostics</h2>
            <div id="dst-diag" style="font-size:12px;">-</div>

            <div id="texttarget" class="d-none">-</div>
            <div id="texttargeterror" class="">-</div>
        </div>
        <div class="col-8 my-2">
            <h2>Information</h2>
            <div id="dst-infotext"></div>
        </div>
    </div>
</div>

<script type="text/javascript" src="./jquery/jquery.min.js"></script>

<script>    //'./dummy.txt'      './cgi-bin/test_return.py'

function yourFunction(){
    $.ajax({ url: './cgi-bin/ups_display.py', success: function(data) { 
        t = document.getElementById("texttarget");
        t.innerHTML = data; 
        
        src = document.getElementById("src-diag");
        dest = document.getElementById("dst-diag");
        dest.innerHTML = src.innerHTML
        
        src = document.getElementById("src-vin");
        dest = document.getElementById("dst-vin");
        dest.innerHTML = src.innerHTML
        
        src = document.getElementById("src-vout");
        dest = document.getElementById("dst-vout");
        dest.innerHTML = src.innerHTML
        
        src = document.getElementById("src-outload");
        dest = document.getElementById("dst-outload");
        dest.innerHTML = src.innerHTML

        src = document.getElementById("src-bchar");
        dest = document.getElementById("dst-bchar");
        dest.innerHTML = src.innerHTML

        src = document.getElementById("src-bvolt");
        dest = document.getElementById("dst-bvolt");
        dest.innerHTML = src.innerHTML

        src = document.getElementById("src-runtime");
        dest = document.getElementById("dst-runtime");
        dest.innerHTML = src.innerHTML

        src = document.getElementById("src-badge-info");
        dest = document.getElementById("dst-badge-info");
        dest.innerHTML = src.innerHTML
        
        src = document.getElementById("src-badge-warn");
        dest = document.getElementById("dst-badge-warn");
        dest.innerHTML = src.innerHTML
        
        src = document.getElementById("src-badge-alert");
        dest = document.getElementById("dst-badge-alert");
        dest.innerHTML = src.innerHTML
        
        src = document.getElementById("src-headline");
        dest = document.getElementById("dst-headline");
        dest.innerHTML = src.innerHTML

        src = document.getElementById("src-topbar-status");
        dest = document.getElementById("dst-topbar-status");
        dest.innerHTML = src.innerHTML

        src = document.getElementById("src-infotext");
        dest = document.getElementById("dst-infotext");
        dest.innerHTML = src.innerHTML
        
        dest = document.getElementById("load-spin");
        dest.classList.add("d-none");

    },
    error: function (request, status, error) {
        t = document.getElementById("texttargeterror")
        t.innerHTML = request.responseText; 
    }
    });
    console.log("Calling")

    setTimeout(yourFunction, 30000);
}

yourFunction();

</script>

<script>
    function SizeDebug ( w ) {
//        document.getElementById("db1").innerHTML = w;    
//        if ( w < 576 ) {
//        document.getElementById("db2").innerHTML = "xs"; return; }
//        if ( w <= 767 ) {
//        document.getElementById("db2").innerHTML = "sm"; return; }
//        if ( w <= 991 ) {
//        document.getElementById("db2").innerHTML = "md"; return; }
//        if ( w <= 1199 ) {
//        document.getElementById("db2").innerHTML = "lg"; return; }
//        document.getElementById("db2").innerHTML = "xl";
    };
</script>

<script>
    $( window ).resize(
        function() {
        var winwid = window.innerWidth;
        SizeDebug ( winwid );
        }
    );
</script>

<script>
    // When the page is loaded, with the width is small the left navbar is collapsed
    var winwid = window.innerWidth;
    SizeDebug ( winwid );
</script>

  </body>
</html>

